---
# Практическое задание 7

## ЭФМО-02-25 

## Алиев Каяхан Командар оглы
---
# Информация о проекте
Подключение и работа с Redis (set/get, TTL). Реализация простого кэша

## Цели занятия
-	Освоить базовые операции работы с Redis из Go-приложения.
-	Научиться использовать команды SET, GET, задавать время жизни ключей (TTL).
-	Реализовать кэширование данных для ускорения работы API.
-	Понять, в каких случаях кэш помогает снизить нагрузку на базу данных.

## Файловая структура проекта:

<img width="1134" height="382" alt="image" src="https://github.com/user-attachments/assets/d1d7da47-616a-4b49-9485-2b90e061bdb3" />

## Ключевые компоненты

cmd/server/main.go — точка входа приложения: создание экземпляра кэша, настройка HTTP-маршрутов /set, /get, /ttl с обработчиками для работы с Redis, запуск сервера на порту 8080.

internal/cache/cache.go — модуль кэширования: обёртка над клиентом Redis, предоставляющая методы Set, Get, TTL для сохранения, получения значений и проверки времени жизни ключей.

Redis (внешняя система) — in-memory key-value хранилище: сервер, работающий на localhost:6379, хранит данные в оперативной памяти с поддержкой TTL (автоматического удаления ключей по истечении времени).

Docker/Redis контейнер — инфраструктурный компонент: способ развёртывания Redis через команду docker run --name redis -p 6379:6379 redis.

go.mod - файл модуля Go: описание зависимостей, версия Go, имя модуля

# Примечания по конфигурации и требования

Для запуска требуется:

Go: версия 1.25.1

PostgreSQL: версия не ниже 14

Docker: версия не ниже 29

<img width="841" height="232" alt="Установка Git и Go" src="https://github.com/user-attachments/assets/8e01d831-5a7f-4376-8348-9052b240aec9" />


# Команды запуска/сборки
Для запуска http нужно выполнить 4 шага:
## 1) Клонировать данный репозиторий в удобную для вас папку:
```Powershell
git clone https://github.com/kayahan81/PZ7-Redis
```
## 2) Перейти в папку http:
```Powershell
cd PZ7-Redis
```
## 3) Загрузка зависимостей:
```Powershell
go mod tidy
```
## 4) Команда запуска
```Powershell
docker run --name redis -p 6379:6379 redis
go run ./cmd/server
```

# Команда сборки
Для сборки бинарника и запуска .exe файла используются данные программы

```Powershell
go build -o server.exe .
server.exe
```
# Проверка работоспособности

## Базовый функционал

Запуск Redis используя Docker

<img width="1384" height="681" alt="image" src="https://github.com/user-attachments/assets/e0159d86-d11e-4e3d-915c-31b243011960" />


Запуск сервера

<img width="1272" height="86" alt="image" src="https://github.com/user-attachments/assets/2c75aac6-8663-452d-a7e7-0826506efb1f" />

## Проверка "ручек"

Hello

<img width="1424" height="461" alt="image" src="https://github.com/user-attachments/assets/b1698ac9-236c-4dfe-a36f-56931173a4f8" />

Создание пользователя

<img width="1434" height="459" alt="image" src="https://github.com/user-attachments/assets/2d27a5aa-abd4-420e-8772-963c8fd2cdb1" />

Получение пользователя

<img width="1430" height="479" alt="image" src="https://github.com/user-attachments/assets/84a33a2a-aa22-451e-b023-59ab55bc958b" />

ttl

<img width="1447" height="503" alt="image" src="https://github.com/user-attachments/assets/412f8808-ad9d-4abf-a935-eedb53334d73" />


#Ответы на вопросы

##1. Чем Redis отличается от реляционной БД?
Redis — это in-memory key-value хранилище, работающее в оперативной памяти и ориентированное на скорость и временные данные, тогда как реляционные БД (PostgreSQL, MySQL) хранят структурированные данные на диске с поддержкой сложных запросов и ACID-транзакций.

##2. Какие типы данных поддерживает Redis кроме строк?
Redis поддерживает списки, множества, хэши, упорядоченные множества, битовые поля, геопространственные данные и потоки, что позволяет использовать его не только как кэш, но и для очередей, счётчиков и реального времени.

##3. Зачем нужен TTL? Приведите примеры.
TTL (время жизни) автоматически удаляет ключи из Redis по истечении заданного времени, что предотвращает накопление устаревших данных — например, для кэширования новостной ленты на 5 минут или хранения сессии пользователя на 30 минут.

##4. Как Redis помогает снизить нагрузку на PostgreSQL?
Redis снижает нагрузку на PostgreSQL, кэшируя результаты частых или тяжёлых запросов в памяти, позволяя возвращать данные клиентам без обращения к основной базе, особенно для редко изменяемой информации.

##5. Что произойдёт, если ключ в Redis «протух» по TTL, а приложение попытается его прочитать?
При чтении ключа с истёкшим TTL Redis вернёт nil/ошибку «key does not exist», что в коде Go вызовет ошибку при вызове Get(), требующую обработки — обычно это сигнал для повторного запроса данных из основного источника.



##5. Как в GORM обработать ошибку нарушения уникального индекса? Что вернёт БД/драйвер?
При нарушении уникального индекса GORM вернёт ошибку, которую можно проверить через db.Error. БД/драйвер возвращает ошибку типа pq: duplicate key value violates unique constraint, которую GORM оборачивает в свою структуру ошибки.
